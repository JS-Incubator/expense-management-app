<!---Header Includes File-->
<%- include('../../includes/header.ejs') %> <%-
include('../../includes/navigation-top.ejs') %>

<!---Start Modal Window-->
<div class="modal-backdrop hide-backdrop"></div>

<!--TODO: Generalize the modal window and make it indepedent  -->
<div class="modal-container hide-modal">
  <h4 class="modal-header">Add New Account</h4>
  <div class="form-container">
    <form id="add-account-form" action="/app/account/add" method="POST">
      <div class="row">
        <div class="input-field">
          <input
            class="validate"
            placeholder="Account Name"
            id="accountName"
            name="accountName"
            type="text"
          />
          <label for="accountName">Account Name</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field">
          <select name="accountType" , id="accountType">
            <!--TODO: Need to generate dynamically -->
            <option value="Bank" selected>Bank</option>
            <option value="Cash">Cash</option>
            <option value="Receivables">Receivables</option>
            <option value="Credit Card">Credit Card</option>
            <option value="Loans">Loans</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="input-field">
          <input
            placeholder="Opening Date"
            id="openingDate"
            name="openingDate"
            type="text"
            class="datepicker col s12 validate"
          />
          <label for="openingData">Opening Date</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field">
          <input
            placeholder="Opening Balance"
            id="openingBalance"
            name="openingBalance"
            type="text"
          />
          <label for="openingBalance">Opening Balance</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field">
          <input
            placeholder="Current Balance"
            id="currentBalance"
            name="currentBalance"
            type="text"
          />
          <label for="currentBalance">Current Balance</label>
        </div>
      </div>

      <div class="row">
        <div class="input-field">
          <select name="currency" id="currency">
            <!--TODO: Need to generate dynamically -->
            <option value="US Dollars" selected>US Dollars</option>
            <option value="Canadian Dollars">Canadian Dollars</option>
          </select>
          <label for="defaultCurrency">Default Currency</label>
        </div>
      </div>

      <div class="row">
        <div class="right-align">
          <button
            type="button"
            class="waves-effect waves-red red btn"
            id="form-cancel"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="waves-effect waves-geen btn add-account"
            id="add-account"
          >
            Add Account
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
<!--End Modal Window -->

<!--Defauld Screen -->
<div class="container">
  <% if ( accounts && accounts.length > 0) { %>
  <div class="table">
    <div class="table-header-container">
      <div class="table-header flex-1">Account Name</div>
      <div class="table-header flex-1 text-center">CM Opening Balance</div>
      <div class="table-header flex-1 text-center">Current Balance</div>
      <div class="table-header flex-2"></div>
    </div>
    <div class="table-body-container">
      <% accountTypes.forEach(type => {%>
      <div class="table-subheader">
        <p><%=type%></p>
      </div>
      <% accounts.forEach((account, index, arr) => {%> <% if
      (account.accountType === type) {%>
      <div class="<%=index%2===0 ? 'table-row stripe' : 'table-row'%>">
        <div class="table-data flex-1"><%=account.accountName%></div>
        <div class="table-data flex-1 text-center">
          <%=account.openingBalance%>
        </div>
        <div class="table-data flex-1 text-center">
          <%=account.currentBalance%>
        </div>
        <div class="table-data flex-2 text-center">
          <a
            href="#"
            class="edit-account-icon"
            data-account-id="<%=account._id%>"
            ><i class="fas fa-edit"></i
          ></a>
        </div>
      </div>
      <%}%> <%})%> <% }) %>
    </div>
  </div>
  <% } else { %>
  <div class="container">
    <div class="row">
      <h3>
        You have no account created yet, Click the button below to get started
      </h3>
    </div>
  </div>
  <% } %>
</div>
<!---Floating Action button-->
<div class="fixed-action-btn" id="add-account-action-button">
  <button class="btn-floating btn-large waves-effect waves-light red">
    <i class="material-icons">add</i>
  </button>
</div>

<!---Navigation bottom include file-->
<%- include('../../includes/navigation-bottom.ejs') %>

<!---Adding script files-->
<script src="/helpers/app/handleModals.js"></script>

<!---Footer includes file-->
<%- include('../../includes/footer.ejs') %>
